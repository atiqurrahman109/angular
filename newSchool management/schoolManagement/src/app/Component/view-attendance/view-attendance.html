<div class="container mt-4">
  <h2 class="mb-4 text-center">Add Attendance</h2>

  <!-- Attendance Form -->
  <form [formGroup]="attForm" (ngSubmit)="addAttendance()" class="card p-4 shadow-sm mb-4">
    <!-- Attendance Date -->
    <div class="mb-3">
      <label for="attendanceDate" class="form-label">Attendance Date</label>
      <input
        type="date"
        id="attendanceDate"
        class="form-control"
        formControlName="attendanceDate"
      />
    </div>

    <!-- Status -->
    <div class="mb-3">
      <label for="status" class="form-label">Status</label>
      <select id="status" class="form-select" formControlName="status">
        <option value="">Select Status</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Leave">Leave</option>
      </select>
    </div>

    <!-- Student -->
    <div formGroupName="student" class="mb-3">
      <label for="student" class="form-label">Student</label>
      <select id="student" class="form-select" formControlName="id">
        <option value="">Select Student</option>
        <option *ngFor="let s of student" [value]="s.id">{{ s.firstName }} {{ s.lastName }} (Roll: {{ s.section }})</option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary w-100" [disabled]="attForm.invalid">Save Attendance</button>
  </form>

  <!-- Attendance Records Table -->
  <h3 class="mb-3">Attendance Records</h3>
  <div *ngIf="loading" class="alert alert-info">Loading attendance records...</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <table *ngIf="!loading && atttendance.length > 0" class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>#</th>
        <th>Date</th>
        <th>Status</th>
        <th>Student Name</th>
        <th>Class</th>
        <th>Roll</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let att of atttendance; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ att.attendanceDate | date: 'dd-MM-yyyy' }}</td>
        <td>
          <span [ngClass]="{
            'badge bg-success': att.status === 'Present',
            'badge bg-danger': att.status === 'Absent',
            'badge bg-warning text-dark': att.status === 'Leave'
          }">
            {{ att.status }}
          </span>
        </td>
        <td>{{ att.student.firstName }} {{ att.student.lastName }}</td>
        <td>{{ att.student.clas }}</td>
        <td>{{ att.student.section}}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && atttendance.length === 0" class="alert alert-warning">
    No attendance records found.
  </div>
</div>
